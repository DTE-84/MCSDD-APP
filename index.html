<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PCSP Assistant Pro | Marion County DMH</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
    <div class="app-container" id="appContainer">

      <!-- ‚îÄ‚îÄ Left Sidebar: Marion County Resources ‚îÄ‚îÄ -->
      <aside class="side-panel">
        <div class="panel-header">Marion County Resources</div>
        <div class="panel-content" id="resourceList"></div>
      </aside>

      <!-- ‚îÄ‚îÄ Main Workspace ‚îÄ‚îÄ -->
      <main class="main-workspace">

        <!-- Sticky Individual Info Header -->
        <div class="individual-header" id="individualHeader">
          <span class="ind-name" id="headerName">No Individual Selected</span>
          <span>üìÖ DOB: <strong id="headerDOB">‚Äî</strong></span>
          <span>ü™™ DMH #: <strong id="headerDMH">‚Äî</strong></span>
        </div>

        <!-- App Title Bar -->
        <div class="app-header">
          <div class="header-left">
            <button class="menu-btn" onclick="toggleSidebar()" title="Toggle Resources">‚ò∞</button>
            <h1>PCSP Assistant <span style="font-weight:300; color:var(--gold)">Pro</span></h1>
          </div>
          <div class="btn-bar">
            <button class="btn btn-outline" onclick="resetForm()">New Plan</button>
          </div>
        </div>

        <!-- HIPAA Privacy Toggle -->
        <div class="privacy-banner">
          <span>üîí HIPAA PRIVACY MODE: [ON] Mask sensitive data while drafting.</span>
          <label class="switch">
            <input type="checkbox" id="privacyToggle" checked onchange="updateUI()" />
            <span class="slider"></span>
          </label>
        </div>

        <!-- ‚îÄ‚îÄ Section 1: Demographics ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-demographics">
          <div class="section-title"><span>1</span> Demographic & System Integration</div>
          <div class="form-grid">
            <div class="field-group">
              <label>Full Legal Name</label>
              <input type="text" id="clientName" placeholder="John Doe" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Date of Birth</label>
              <input type="date" id="clientDOB" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>DMH ID Number</label>
              <input type="text" id="dmhID" placeholder="7 digits" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>PCSP Implementation Date</label>
              <input type="date" id="ispDate" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>MOEDIWEB Updated Date</label>
              <input type="date" id="moediDate" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>CIMOR Updated Date</label>
              <input type="date" id="cimorDate" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Last Assessment Date</label>
              <input type="date" id="lastAssessment" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Last LOC Date</label>
              <input type="date" id="lastLOC" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>RAS or SIS Score</label>
              <input type="text" id="rasSisScore" placeholder="Score (or 'None')" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>TCM Agency / Coordinator</label>
              <input type="text" id="coordinator" placeholder="Marion Co. Services Board" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Healthcare Resources</label>
              <select id="insurance" onchange="updateUI()">
                <option value="Medicaid">Medicaid (MO HealthNet)</option>
                <option value="Medicare">Medicare</option>
                <option value="Private Insurance">Private Insurance</option>
                <option value="None/Pending">None / Pending</option>
              </select>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Section 2: Vision for a Good Life ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-vision">
          <div class="section-title"><span>2</span> Vision for a Good Life</div>
          <div class="form-grid">
            <div class="field-group full">
              <label>Personal Aspirations (Future Hopes & Dreams)</label>
              <textarea id="aspirations" placeholder="What does a 'Good Life' look like for this individual? (Include their own words)" oninput="updateUI()"></textarea>
            </div>
            <div class="field-group full">
              <label>Previous Goals Progress (Summary of last year)</label>
              <textarea id="prevGoals" placeholder="Discuss progress/lack of progress on previous PCSP goals. Mention if mastered or discontinued." oninput="updateUI()"></textarea>
            </div>
            <div class="field-group full">
              <label>Strengths & Assets (Skills, Abilities, Passions)</label>
              <textarea id="strengths" placeholder="E.g. Friendly, uses iPad for communication, strong walker... relation to goals?" oninput="updateUI()"></textarea>
            </div>
            <div class="field-group half">
              <label>Technology Helpers</label>
              <input type="text" id="techHelpers" placeholder="Apps, tablets, adaptive utensils, etc." oninput="updateUI()" />
            </div>
            <div class="field-group half">
              <label>Relationships (Family, Friends, Natural Supports)</label>
              <input type="text" id="relationships" placeholder="Who helps achieve these goals?" oninput="updateUI()" />
            </div>
            <div class="field-group full">
              <label>Community Resources (Clubs, Library, Job Centers)</label>
              <textarea id="communityResources" placeholder="Clubs, Vocational Rehab, Centers for Independent Living..." oninput="updateUI()"></textarea>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Section 3: Health, Safety & Risk ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-health">
          <div class="section-title"><span>3</span> Health, Safety & Risk Planning</div>
          <div class="form-grid">
            <div class="field-group">
              <label>Provider Risk Level</label>
              <select id="riskLevel" onchange="updateUI()">
                <option value="Low (Routine)">Low Risk</option>
                <option value="Moderate (Community)">Moderate Risk</option>
                <option value="High (Behavioral)">High Risk</option>
              </select>
            </div>
            <div class="field-group">
              <label>Supervision Level</label>
              <select id="supervisionLevel" onchange="updateUI()">
                <option value="Standard">Standard</option>
                <option value="Line of Sight">Line of Sight</option>
                <option value="1:1 Constant">1:1 Constant</option>
                <option value="Altered (See Notes)">Altered Protocol</option>
              </select>
            </div>
            <div class="field-group">
              <label>Behavioral Support</label>
              <select id="behavioralStatus" onchange="updateUI()">
                <option value="None">None Needed</option>
                <option value="FBA in Progress">FBA in Progress</option>
                <option value="BSP Active">BSP Active</option>
                <option value="ATSC Involved">ATSC Involved</option>
              </select>
            </div>
            <div class="field-group half">
              <label>Staff Precaution (OSHA 3148)</label>
              <select id="oshaPrecaution" onchange="updateUI()">
                <option value="Standard universal precautions apply.">Standard Precautions</option>
                <option value="Two-staff escort required for community.">2-Staff Escort Protocol</option>
                <option value="Staff to maintain clear path to exit.">Environmental Awareness</option>
                <option value="Utilize de-escalation (Mandt/NCI).">De-escalation Protocol</option>
              </select>
            </div>
            <div class="field-group full">
              <label>Medication, Dietary & Mobility Risks</label>
              <textarea id="medSupport" placeholder="List medications, diet (e.g. Mechanical Soft/Choking Risk), and mobility needs (e.g. Falls risk)." oninput="updateUI()"></textarea>
            </div>
            <div class="field-group full">
              <label>Emergency Evacuation & 911 Support</label>
              <input type="text" id="evacPlan" placeholder="E.g. Independent exit, 1:1 assist, ability to call 911." oninput="updateUI()" />
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Section 4: Legal & Rights ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-legal">
          <div class="section-title"><span>4</span> Legal, Rights & Satisfaction</div>
          <div class="form-grid">
            <div class="field-group">
              <label>Legal Status</label>
              <select id="legalStatus" onchange="updateUI()">
                <option value="Self / Full Rights">Self / Full Rights</option>
                <option value="Full Guardianship">Full Guardianship</option>
                <option value="Limited Guardianship">Limited Guardianship</option>
                <option value="Power of Attorney">Power of Attorney</option>
              </select>
            </div>
            <div class="field-group">
              <label>Rights Brochure Addressed?</label>
              <select id="rightsBrochure" onchange="updateUI()">
                <option value="Yes">Yes - Knowing Your Rights</option>
                <option value="No">No</option>
              </select>
            </div>
            <div class="field-group">
              <label>Consents on File?</label>
              <select id="consents" onchange="updateUI()">
                <option value="Yes - All signed">Yes - All signed</option>
                <option value="Pending">Pending</option>
              </select>
            </div>
            <div class="field-group full">
              <label>Satisfaction with Services (Spelled out by service)</label>
              <textarea id="serviceSatisfaction" placeholder="E.g. Individual is satisfied with TCM, Community Health, and MCSDD Grant programs." oninput="updateUI()"></textarea>
            </div>
            <div class="field-group full">
              <label>Conflict of Interest Info Provided?</label>
              <select id="conflictInfo" onchange="updateUI()">
                <option value="Yes">Yes - Clear information provided</option>
                <option value="No">No</option>
              </select>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Section 5: Contributors & Administration ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-admin">
          <div class="section-title"><span>5</span> Contributors & Administration</div>
          <div class="form-grid">
            <div class="field-group full">
              <label>Plan Contributors (Who was involved?)</label>
              <input type="text" id="contributors" placeholder="E.g. Individual, Guardian, SC, Provider Name..." oninput="updateUI()" />
            </div>
            <div class="field-group full">
              <label>Participation Statement</label>
              <textarea id="participation" placeholder="How did the individual participate? If not present, provide justification." oninput="updateUI()"></textarea>
            </div>
            <div class="field-group">
              <label>SC Visit Frequency</label>
              <input type="text" id="scFrequency" placeholder="E.g. Face-to-face monthly" oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Payee / Monthly Spending Info</label>
              <input type="text" id="payeeInfo" placeholder="If HSO is payee, discuss spending info." oninput="updateUI()" />
            </div>
            <div class="field-group">
              <label>Burial Info (Placement only)</label>
              <input type="text" id="burialInfo" placeholder="Address if applicable" oninput="updateUI()" />
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ Section 6: Measurable Outcomes ‚îÄ‚îÄ -->
        <div class="form-section" id="sec-outcomes">
          <div class="section-title"><span>6</span> Measurable Outcomes Generator</div>
          <div class="form-grid">
            <div class="field-group">
              <label>Outcome Domain</label>
              <select id="domain" onchange="loadTemplates()">
                <option value="">-- Select --</option>
                <option value="Safety">Safety & Security</option>
                <option value="Daily">Daily Life & Employment</option>
                <option value="Community">Community Living</option>
                <option value="Health">Healthy Living</option>
              </select>
            </div>
            <div class="field-group">
              <label>Support Method</label>
              <select id="verb" onchange="updateUI()">
                <option value="instructional support to learn how to">Instructional (Teaching)</option>
                <option value="maintenance support to continue to">Maintenance (Sharpness)</option>
                <option value="physical and direct support to">Physical/Direct (Hands-on)</option>
                <option value="modeling and demonstration to">Model (Show/Tell)</option>
                <option value="verbal prompts and cues to">Prompt (Reminders)</option>
              </select>
            </div>
            <div class="field-group">
              <label>Frequency</label>
              <input type="text" id="frequency" placeholder="e.g. 3x weekly" oninput="updateUI()" />
            </div>
            <div class="field-group full">
              <label>Goal Starter (Clinical Building Blocks)</label>
              <select id="goalTemplate" onchange="updateUI()"></select>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ PCSP Document Preview & Export ‚îÄ‚îÄ -->
        <div class="output-section">
          <div class="section-title" style="color:var(--marion-blue); border-color:var(--marion-blue)">
            PCSP DOCUMENT PREVIEW
          </div>
          <div id="narrativeDisplay">
            Complete sections to generate the full Missouri PCSP summary...
          </div>
          <div class="btn-bar">
            <button class="btn btn-primary" onclick="copyToClipboard()">üìã Copy Summary</button>
            <button class="btn btn-success" onclick="printPlan()">üñ®Ô∏è Print / Save PDF</button>
            <button class="btn btn-outline" onclick="saveToHistory()">üíæ Save Draft</button>
            <button class="btn btn-export" onclick="exportPCSP()">‚¨áÔ∏è Export .pcsp File</button>
            <label class="btn btn-import" title="Open a previously saved .pcsp file">
              üìÇ Open .pcsp File
              <input type="file" id="importFileInput" accept=".pcsp,.json" style="display:none;" onchange="importPCSP(event)" />
            </label>
          </div>
        </div>

      </main>

      <!-- ‚îÄ‚îÄ Right Sidebar: Saved Drafts ‚îÄ‚îÄ -->
      <aside class="side-panel right">
        <div class="panel-header">Saved Drafts</div>
        <div class="panel-content" id="historyList"></div>
      </aside>

    </div>

    <div id="toast" class="toast"></div>
    <script src="app.js"></script>
  </body>
</html>
